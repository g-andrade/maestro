<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>maestro</title>
<link rel="stylesheet" type="text/css" href="stylesheet.css" title="EDoc">
</head>
<body bgcolor="white">
<div class="navbar"><a name="#navbar_top"></a><table width="100%" border="0" cellspacing="0" cellpadding="2" summary="navigation bar"><tr><td><a href="overview-summary.html" target="overviewFrame">Overview</a></td><td><a href="http://www.erlang.org/"><img src="erlang.png" align="right" border="0" alt="erlang logo"></a></td></tr></table></div>
<h1>maestro</h1>
<p>Copyright © 2015 Guilherme Andrade</p>
<p><b>Version:</b> 1.0.0</p>
<p><b>Authors:</b> Guilherme Andrade (<a href="mailto:g@gandrade.net"><tt>g@gandrade.net</tt></a>).</p>
<p><code>maestro</code>: a pool of pools for when single pool managers become a bottleneck.</p>

<hr>

<h3><a name="Why?">Why?</a></h3><p>
Big worker pools for short-lived I/O tasks (e.g. database access) can easily overrun a single <code>poolboy</code> manager due to too much check-in / check-out activity.</p>

<h3><a name="How?">How?</a></h3><p>
Take the naïve approach and launch multiple pools; pick them at random when checking out. Having <code>maestro</code> be aware of each pool workload would be nice but it would increase complexity and lower performance without any significant advantages when all the pools are already under a similar load pattern.</p>

<h3><a name="How_do_I_use_it?">How do I use it?</a></h3>
<pre lang="erlang">
MaestroName = many_pools,
Conf = [% maestro options
        {name, MaestroName},
        {pool_module, poolboy},
        {pool_count, 3},
        {use_named_pools, false},

        % poolboy options
        {worker_module, fabulous_worker},
        {size, 100},
        {max_overflow, 50}],

{ok, _} = maestro:start(Conf),

{SomePool, Worker1} = maestro:checkout(MaestroName),
thing_done = gen_server:call(Worker1, do_your_thing),
ok = maestro:pool_checkin(SomePool, Worker1),

also_done = maestro:transaction(
        MaestroName,
        fun (Worker) -&gt; gen_server:call(Worker, do_your_other_thing) end),

ok = maestro:stop(MaestroName).
</pre>

<hr>
<div class="navbar"><a name="#navbar_bottom"></a><table width="100%" border="0" cellspacing="0" cellpadding="2" summary="navigation bar"><tr><td><a href="overview-summary.html" target="overviewFrame">Overview</a></td><td><a href="http://www.erlang.org/"><img src="erlang.png" align="right" border="0" alt="erlang logo"></a></td></tr></table></div>
<p><i>Generated by EDoc, Sep 27 2015, 17:13:58.</i></p>
</body>
</html>
